if(void 0!==Tracker)throw"Tracker class already exists";function ownKeys(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var Tracker=function(){function n(e){var t=this;_classCallCheck(this,n),this.gaid=void 0===e.gaid?null:e.gaid,this.selectors=void 0===e.selectors?[]:e.selectors.map(function(e){return _objectSpread(_objectSpread({},{viewsEnabled:!0}),e)}),"undefined"==typeof gtag?this.insertGTAG(this.gaid,function(){gtag("config",t.gaid,{send_page_view:!1,groups:"blz_ga_tracker"})}):gtag("config",this.gaid,{send_page_view:!1,groups:"blz_ga_tracker"}),this.IntersectingEventCheck=this.IntersectingEventCheck.bind(this),this.trackEvt=this.trackEvt.bind(this),this.observer=new IntersectionObserver(function(e){e.forEach(t.IntersectingEventCheck)}),this.init()}return _createClass(n,[{key:"IntersectingEventCheck",value:function(e){var t;e.isIntersecting&&(t=JSON.parse(e.target.dataset.blzTrackingData),this.trackEvt(t.action,t.args,this.gaid),this.observer.unobserve(e.target))}},{key:"init",value:function(){var t=this;this.selectors.forEach(function(e){return t._initSelector(e)})}},{key:"_initSelector",value:function(n){var e,i=this;"event"===n.type&&(e=document.querySelectorAll(n.selector),[].map.call(e,function(e){var t=void 0!==n.args?n.args:{event_category:"track"};i.initClick(e,n.name,t),n.viewsEnabled&&i.initView(e,n.name,t)}))}},{key:"initView",value:function(e,t,n){void 0===e.dataset.blzTracking&&(e.dataset.blzTrackingData=JSON.stringify({action:t+" view",args:n}),this.observer.observe(e))}},{key:"initClick",value:function(e,t,n){var i=this,a=t+" click";e.addEventListener("click",function(){return i.trackEvt(a,n)})}},{key:"add",value:function(e,t,n,i,a){a={selector:e,type:t,name:n,viewsEnabled:void 0===a||a};void 0!==i&&(a.args=i),this._initSelector(a)}},{key:"trackPV",value:function(e,t){var n,i,a=void 0!==t?t:this.gaid;null!=a&&(i=n=null,t=window.location.pathname+window.location.search+window.location.hash,null!=e?(n=void 0!==e.page_title?e.page_title:document.title,i=void 0!==e.page_path?e.page_path:t,gtag("config",a,{page_title:n,page_path:i})):gtag("config",a))}},{key:"trackEvt",value:function(e,t,n){var n=void 0!==n?n:this.gaid;null!=n&&void 0!==e&&null!=e&&""!=e&&(n={send_to:"blz_ga_tracker"},void 0!==t?gtag("event",e,_objectSpread(_objectSpread({},n),t)):gtag("event",e,n))}},{key:"insertGTAG",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},n=document.createElement("script");n.async=!0,n.src="https://www.googletagmanager.com/gtag/js?id=".concat(e),n.addEventListener("load",t);t=document.createElement("script");t.textContent="\n            window.dataLayer = window.dataLayer || [];\n            function gtag(){ dataLayer.push(arguments); }\n            gtag('set', { 'send_page_view': false });\n            gtag('js', new Date());            \n        ",document.head.appendChild(n),document.head.appendChild(t)}}]),n}();